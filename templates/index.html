<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Bambu Labs Kiosk</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üñ®Ô∏è Bambu Labs Printer</h1>
            <div class="status-bar">
                <span id="printer-status">Connecting...</span>
                <button id="light-toggle" class="btn btn-secondary">üí° Light</button>
            </div>
        </header>

        <main>
            <!-- Printer Status Section -->
            <section class="status-section">
                <h2>Printer Status</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <span class="status-label">State:</span>
                        <span id="state" class="status-value">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Temperature:</span>
                        <span id="temperature" class="status-value">-</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Time Remaining:</span>
                        <span id="time_remaining" class="status-value">-</span>
                    </div>
                </div>
            </section>

            <!-- File Selection Section -->
            <section class="files-section">
                <h2>Pick the pathway you are most interested in</h2>
                <div class="files-grid" id="files-grid">
                    {% for file in files %}
                    <div class="file-card" data-filename="{{ file.name }}">
                        <div class="file-icon"><img src="data:image/png;base64, {{ file.image_data }}" alt="Loaded Image"></div>
                    </div>
                    {% endfor %}
                </div>
                {% if not files %}
                <p class="no-files">No print files available. Please add .3mf or .gcode files to the print_files directory.</p>
                {% endif %}
            </section>

            <!-- AMS Color Selection Section -->
            <section class="ams-section" id="ams-section">
                <h2>Select a color</h2>
                <div class="ams-grid">
                    {% for slot_id, slot_info in ams_slots.items() %}
                    <div class="ams-slot" data-slot="{{ slot_id }}">
                        <div class="color-indicator" style="background-color: {{ slot_info.color }}"></div>
                    </div>
                    {% endfor %}
                </div>
            </section>

            <!-- Action Buttons -->
            <section class="actions-section" id="actions-section" style="display: none;">
                <button id="print-btn" class="btn btn-primary btn-large">üöÄ Start Print</button>
                <button id="cancel-selection-btn" class="btn btn-secondary btn-large">‚ùå Cancel</button>
            </section>

            <!-- Active Print Section -->
            <section class="active-print-section" id="active-print-section" style="display: none;">
                <h2>Current Print</h2>
                <div class="print-info">
                    <p><strong>File:</strong> <span id="current-file">-</span></p>
                    <p><strong>AMS Slot:</strong> <span id="current-slot">-</span></p>
                </div>
            </section>
        </main>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>